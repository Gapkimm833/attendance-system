<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>ระบบเช็คชื่อเข้าเรียน</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <header class="navbar">
    <div class="container">
      <img src="{{ url_for('static', filename='logo.jpg') }}" alt="โลโก้โรงเรียน" class="logo">
      <h1>ระบบเช็คชื่อเข้าเรียน</h1>
      <span class="subtitle">โรงเรียนสารสาสน์วิเทศรังสิต - ตัดสายเวลา <b>08:35</b></span>
    </div>
  </header>

  <main class="container">
    <div class="grid">
      <!-- ฟอร์มเช็คชื่อ -->
      <section class="card">
        <h2>เช็คชื่อเข้าเรียน</h2>
        <form method="POST">
          <label for="student_id">รหัสนักเรียน</label>
          <input type="text" name="student_id" placeholder="เช่น 6512345678" required>

          <label for="name">ชื่อ - นามสกุล</label>
          <input type="text" name="name" placeholder="เช่น สมชาย ใจดี" required>

          <button type="submit" class="btn">บันทึกเช็คชื่อ</button>
          <button type="reset" class="btn secondary">ล้างฟอร์ม</button>
        </form>
      </section>

      <!-- QR Code -->
      <section class="card">
        <h2>สแกนเช็คชื่อด้วย QR</h2>
        <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data={{ request.url_root }}" alt="QR Code">
        <p class="note">
          • ใช้เฉพาะนักเรียนที่อยู่ในห้องเรียนเท่านั้น <br>
          • กรอกข้อมูลตามจริง หากตรวจพบความผิดปกติจะถือว่า "ขาด"<br>
          • ระบบจะบันทึก "มาสาย" หากเช็คหลังเวลา <b>08:35</b>
        </p>
      </section>
    </div>

    <!-- ตารางแสดงผล -->
    <section class="card full">
      <h2>รายการเช็คชื่อล่าสุด (วันที่ {{ today }})</h2>
      <div class="actions">
        <a href="{{ url_for('export_excel') }}" class="btn">ดาวน์โหลด Excel</a>
        <a href="{{ url_for('delete_today') }}" class="btn danger">เริ่มวันใหม่ (ลบรายการวันนี้)</a>
        <a href="{{ url_for('delete_all') }}" class="btn danger">ลบข้อมูลทั้งหมด</a>
      </div>

      <table>
        <thead>
          <tr>
            <th>รหัสนักเรียน</th>
            <th>ชื่อ - นามสกุล</th>
            <th>วันที่</th>
            <th>เวลา</th>
            <th>สถานะ</th>
          </tr>
        </thead>
        <tbody>
          {% if rows %}
            {% for row in rows %}
            <tr>
              <td>{{ row["student_id"] }}</td>
              <td>{{ row["name"] }}</td>
              <td>{{ row["date"] }}</td>
              <td>{{ row["time"] }}</td>
              <td>{{ row["status"] }}</td>
            </tr>
            {% endfor %}
          {% else %}
            <tr><td colspan="5" style="text-align:center;">ยังไม่มีข้อมูล</td></tr>
          {% endif %}
        </tbody>
      </table>
    </section>
  </main>

  <footer>
    <p>© ระบบเช็คชื่อ - โรงเรียนสารสาสน์วิเทศรังสิต</p>
  </footer>
</body>
</html>
